<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0"/>
    <meta name="format-detection" content="telephone=no,email=no,date=no,address=no">
    <title>云API</title>
    <link rel="stylesheet" type="text/css" href="../../css/api.css"/>
    <link rel="stylesheet" type="text/css" href="../../css/style.css"/>
    <link rel="stylesheet" type="text/css" href="../../css/aui.css"/>
    <style>

        .zizhuzhaosheng {
          font-family: 'PingFang-SC';
          font-size: 10px;
          color: #fff;
        }
        .zizhuzhaoshengkuan {
          width: 50px;
          height: 14px;
          border-radius: 2px;
          background-color: #36c7fa;
          display: inline-block!important;
          text-align: center!important;
          }
          .biaoti {
            font-family: 'PingFang-SC';
            font-size: 16px;
            color: #333333;
          }
          .shuoming {
            font-family: 'PingFang-SC';
            font-size: 10px;
            color: #666666;
            width: 16em;
            margin-left: 8px;
            display: inline-block;
          }
          select {
            padding-left: 5px;
          }
          .nianfen {
            font-family: 'PingFang-SC';
            font-size: 14px;
            line-height: 1.25;
            color: #666666;
            width: 20%;
            height: 23px;
           border-radius: 5px;
           border: solid 1px #6666ff;
           background: url(../../image/41-8.png) no-repeat scroll 95% center transparent;
           background-size: 14px;
          }

          table{
            width: 100%;
            text-align: center;
          }
          tr{
            font-size: 12px;
          }
          .chakan{
            font-family: 'PingFang-SC';
            color: #0281f9;
          }
          .aui-tab-item.aui-active {
              color: #6666ff;
              border-bottom: 2px solid #6666ff;
          }

          .title_panel{
            width: 100%;
            height: auto;
            padding-top: 8px;
            padding-bottom: 8px;
            border-top: 1px solid #f2f2f2;
            background-color: #f2f2f2;
            padding-left: 10px;
            font-size: 16px;
            font-family: 'PingFang-SC';
          }
          .tab-position{
            width: 100%;
            position: fixed;
            z-index: 3;
            top: 0px;
          }
    </style>
</head>
<body style="font-family: 'PingFang-SC';">
    <div class="aui-tab tab-position" id="tab">
        <div class="aui-tab-item aui-active">资讯</div>
        <div class="aui-tab-item"><div></div>方略</div>
        <div class="aui-tab-item">普通高校</div>
        <div class="aui-tab-item">艺术团</div>

    </div>

    <div class="aui-content aui-margin-b-15" style="display:block;padding-top:46px;" id="yizixun">
        <ul class="aui-list aui-media-list" id="yishuzx_ul">
          <script id="yishuzx_s" type="text/x-dot-template">
          {{for (var i = 0; i < it.length; i++) {}}
            <li class="aui-list-item" tapmode onclick="onZItemClick({{=i}})">
                <div class="aui-media-list-item-inner">
                    <div class="aui-list-item-inner">
                        <div class="aui-list-item-text">
                            <div class="aui-list-item-title biaoti">{{=it[i].name}}</div>
                        </div>
                    </div>
                </div>
                <div class="aui-info" style="padding-top:0">
                    <div class="aui-info-item zizhuzhaoshengkuan">
                      <span class="zizhuzhaosheng">艺术招生</span>
                    </div>
                    <div class="aui-info-item zizhuzhaosheng">{{=it[i].time}}</div>
                </div>
            </li>
          {{}}}
          </script>
        </ul>
    </div>


    <div class="aui-content aui-margin-b-15" style="display:none;padding-top:46px;" id="yifangluo">
        <ul class="aui-list aui-media-list" id="fanglue_ul">
          <script id="fanglue_s" type="text/x-dot-template">
            {{for (var i = 0; i < it.length; i++) {}}
              <li class="aui-list-item" tapmode onclick="onFItemClick({{=i}})">
                  <div class="aui-media-list-item-inner">

                      <div class="aui-list-item-inner">
                          <div class="aui-list-item-text">
                              <div class="aui-list-item-title biaoti">{{=it[i].name}}</div>
                          </div>
                      </div>
                  </div>
                  <div class="aui-info" style="padding-top:0">
                      <div class="aui-info-item zizhuzhaoshengkuan">
                        <span class="zizhuzhaosheng">艺术招生</span>
                      </div>
                      <div class="aui-info-item zizhuzhaosheng">{{=it[i].time}}</div>
                  </div>
              </li>
          {{}}}
        </script>
        </ul>
    </div>

    <div class="aui-content aui-margin-b-15" style="display:none;padding-top:46px;"id="puzhaosheng">
        <div style="width:100%;padding:8px 10px;background-color:white;border-top:1px solid #f2f2f2;">
          <select class="nianfen" name="" style="display:inline-block; width:10em;" tapmode onchange="onSchoolType(this.value)">
            <option value="1">非独立艺术学校</option>
            <option value="2">独立艺术学校</option>
          </select>

          <div class="shuoming" id="school_addr">
              院校归属地：
                <select id="addr_sl" class="nianfen" style="display: inline-block;width:5em" tapmode onchange="onProvince(this.value)">
                  <script id="addr_s" type="text/x-dot-template">
                    {{for (var i = 0; i < it.length; i++) {}}
                      <option>{{=it[i]}}</option>
                      {{}}}
                  </script>
                </select>

          </div>
        </div>
        <div class="title_panel" id="title31" style="display:none;">
            <span class="list_title">本科艺术院校招生简章</span>
        </div>
        <ul class="aui-list aui-media-list" id="ptgx_ul">
            <script id="ptgx_s" type="text/x-dot-template">

            {{for (var i = 0; i < it.list.length; i++) {}}
              <li class="aui-list-item" id="list31_ul" tapmode onclick="onFirstItemClick({{=i}})">
                  <div class="aui-media-list-item-inner">
                      <div class="aui-list-item-inner">
                          <div class="aui-list-item-text">
                              <div class="aui-list-item-title biaoti">{{=it.list[i].univ_name}}</div>
                          </div>
                      </div>
                  </div>
              </li>
              {{}}}
            </script>
        </ul>


        <div class="title_panel" id="title13" style="display:none;">
            <span class="list_title">教育部批准13所本科艺术院校招生简章</span>
        </div>
        <ul class="aui-list aui-media-list" id="list13_ul" style="display:none;">
          <script id="list13_s" type="text/x-dot-template">
          {{for (var i = 0; i < it.length; i++) {}}
            <li class="aui-list-item" tapmode onclick="onSecondItemClick({{=i}})">
                <div class="aui-media-list-item-inner">
                    <div class="aui-list-item-inner">
                        <div class="aui-list-item-text">
                            <div class="aui-list-item-title biaoti">{{=it[i].univ_name}}</div>
                        </div>
                    </div>
                </div>
            </li>
          {{}}}
        </script>
        </ul>
    </div>

    <div class="aui-content aui-margin-b-15" id="yishutuan"  style="display:none;padding-top:46px;">
        <li class="aui-list-header" style="background: #fff;padding:4px;border-top:1px solid #f2f2f2;">
          <span class="">
              院校归属
          </span>
          <select id="shengfen_sl" class="nianfen" style="display:inline-block;"tapmode onchange="shengfen(this.value)">
            <script id="shengfen_s" type="text/x-dot-template">
            {{for (var i = 0; i < it.length; i++) {}}
              <option>{{=it[i].province}}</option>
            {{}}}
            </script>
          </select>
        </li>

        <ul class="aui-list aui-media-list">
          <table border="1" id="ystjz_tb">
            <script id="ystjz_s" type="text/x-dot-template">
            <tr>
              <th>院校属地</th>
              <th>院 校</th>
              <th>招生简章</th>
              <th>报名时间</th>
              <th>招生类别</th>
            </tr>

            {{for (var i = 0; i < it.length; i++) {}}
              <tr>
                <td>{{=it[i].province}}</td>
                <td style="width: 20%;">{{=it[i].univ_name}}</td>
                <td class="chakan" tapmode onclick="checkYSTJZDetails({{=i}})">查看</td>
                {{if (it[i].bm_time == null) {}}
                  <td style="width: 25%;">-</td>
                {{}else{}}
                  <td style="width: 25%;">{{=it[i].bm_time}}</td>
                {{}}}
                <td style="width: 25%;">{{=it[i].major}}</td>
              </tr>
            {{}}}
          </script>
          </table>
        </ul>
    </div>
</body>
<script type="text/javascript" src="../../script/api.js" ></script>
<script type="text/javascript" src="../../script/aui-tab.js" ></script>
<script type="text/javascript" src="../../script/doT.js" ></script>
<script type="text/javascript">
    var zixunData = [];
    var fangLueData = [];
    var flag_arr = [1, 0, 0, 0];
    var feiduliList = [];
    var provinceList = [];
    var yuanxiao;

    var ystjz_dot;
    apiready = function(){
        api.parseTapmode();

        getZiXunData();
    }
    var tab = new auiTab({
        element:document.getElementById("tab"),
    },function(ret){
        if (ret.index==1) {
          document.getElementById('yizixun').style.display = "block"
          document.getElementById('yifangluo').style.display = "none"
          document.getElementById('puzhaosheng').style.display = "none"
          document.getElementById('yishutuan').style.display = "none"
        }else if (ret.index==2) {
          document.getElementById('yizixun').style.display = "none"
          document.getElementById('yifangluo').style.display = "block"
          document.getElementById('puzhaosheng').style.display = "none"
          document.getElementById('yishutuan').style.display = "none"
          if (flag_arr[ret.index - 1] == 0) {
              flag_arr[ret.index - 1] = 1;
              getFangLV();
          }

        }else if (ret.index==3) {
          document.getElementById('yizixun').style.display = "none"
          document.getElementById('yifangluo').style.display = "none"
          document.getElementById('puzhaosheng').style.display = "block"
          document.getElementById('yishutuan').style.display = "none"
          if (flag_arr[ret.index - 1] == 0) {
              flag_arr[ret.index - 1] = 1;
              getPuTongGaoXiao();
          }
        }else {
          document.getElementById('yizixun').style.display = "none"
          document.getElementById('yifangluo').style.display = "none"
          document.getElementById('puzhaosheng').style.display = "none"
          document.getElementById('yishutuan').style.display = "block"
          if (flag_arr[ret.index - 1] == 0) {
              flag_arr[ret.index - 1] = 1;
              getYiShuTuan();
          }
        }
    });

    // 初次打开资讯
    function getZiXunData() {
      api.showProgress({
          style: 'default',
          animationType: 'fade',
          title: '努力加载中...',
          text: '先喝杯茶...',
          modal: false
      });

      api.ajax({
          url: 'http://www.yxke12.com/index.php/App/Yishulei/zixun.html',
          method: 'post',
          data: {
              values: {
                  name: 'haha'
              },
          }
      },function(ret, err){
        api.hideProgress();
          if (ret) {
              zixunData = ret.data;
              var zixun = doT.template(document.getElementById('yishuzx_s').innerHTML);
              document.getElementById('yishuzx_ul').innerHTML = zixun(zixunData);
              api.parseTapmode();
          } else {
            api.toast({
            msg: JSON.stringify(err.msg),
            duration: 2000,
            location: 'bottom'
        });
          }
      });
    }

    // 初次打开方略
    function getFangLV() {
        api.showProgress({
            style: 'default',
            animationType: 'fade',
            title: '努力加载中...',
            text: '先喝杯茶...',
            modal: true
        });

        api.ajax({
            url: 'http://www.yxke12.com/index.php/App/Yishulei/fanglue.html',
            method: 'post',
            data: {
                values: {

                }
            }
        },function(ret, err){
          api.hideProgress();
            if (ret) {
              if (ret.status == 100) {
                  // console.log( JSON.stringify( ret ) );
                  fangLueData = ret.data;
                  var zizhuzhaosheng = doT.template(document.getElementById('fanglue_s').innerHTML);
                  document.getElementById('fanglue_ul').innerHTML = zizhuzhaosheng(fangLueData);
                  api.parseTapmode();
              }
            } else {
              api.toast({
              msg: JSON.stringify(err.msg),
              duration: 2000,
              location: 'bottom'
          });
            }
        });
    }

    // 普通高校 简章列表
    function getPuTongGaoXiao() {
      api.showProgress({
          style: 'default',
          animationType: 'fade',
          title: '努力加载中...',
          text: '先喝杯茶...',
          modal: true
      });

      api.ajax({
          url: 'http://www.yxke12.com/index.php/App/Yishulei/feiduli.html',
          method: 'post',
          data: {
              values: {

              }
          }
      },function(ret, err){
        api.hideProgress();
          if (ret) {
            if (ret.status == 100) {
                // console.log( JSON.stringify( ret ) );
                feiduliList = ret.data.lists;
                provinceList = [];
                 var provinceObj = ret.data.province;
                 for (var key in provinceObj) {
                   if (provinceObj.hasOwnProperty(key)) {
                      provinceList.push(provinceObj[key]);
                   }
                 }
                var obj = {};
                obj.list = feiduliList;
                obj.province = provinceList;
                // console.log(JSON.stringify(obj));
                yuanxiao = doT.template(document.getElementById('ptgx_s').innerHTML);
                document.getElementById('ptgx_ul').innerHTML = yuanxiao(obj);

                var addr = doT.template(document.getElementById('addr_s').innerHTML);
                document.getElementById('addr_sl').innerHTML = addr(provinceList);
                api.parseTapmode();
            }
          } else {
            api.toast({
            msg: JSON.stringify(err.msg),
            duration: 2000,
            location: 'bottom'
        });
          }
      });
    }
    var ystProvinceList = [];
    var ystJZList = [];
    function getYiShuTuan() {
        api.showProgress({
            style: 'default',
            animationType: 'fade',
            title: '努力加载中...',
            text: '先喝杯茶...',
            modal: true
        });

        api.ajax({
            url: 'http://www.yxke12.com/index.php/App/Yishulei/yishutuan.html',
            method: 'post',
            data: {
                values: {
                }
            }
        },function(ret, err){
          api.hideProgress();
            if (ret) {
                if (ret.status == 100) {
                  console.log( JSON.stringify( ret ) );
                  ystProvinceList = ret.data.province;
                  ystJZList = ret.data.lists;
                  if (ystjz_dot == null) {
                    ystjz_dot = doT.template(document.getElementById('ystjz_s').innerHTML);
                  }
                  document.getElementById('ystjz_tb').innerHTML = ystjz_dot(ystJZList);

                  var province = doT.template(document.getElementById('shengfen_s').innerHTML);
                  document.getElementById('shengfen_sl').innerHTML = province(ystProvinceList);
                  api.parseTapmode();

                }
            } else {
              api.toast({
              msg: JSON.stringify(err.msg),
              duration: 2000,
              location: 'bottom'
          });
            }
        });


    }
    var duliDataList31 = [];
    function getDuliYS() {
      api.showProgress({
          style: 'default',
          animationType: 'fade',
          title: '努力加载中...',
          text: '先喝杯茶...',
          modal: true
      });

      api.ajax({
          url: 'http://www.yxke12.com/index.php/App/Yishulei/dulione.html',
          method: 'post',
          data: {
              values: {
              }
          }
      },function(ret, err){
        api.hideProgress();
          if (ret) {
              console.log( JSON.stringify( ret ) );
              duliDataList31 = ret.data;
              var obj = {};
              obj.list = duliDataList31;
              obj.province = provinceList;
              document.getElementById('ptgx_ul').innerHTML = yuanxiao(obj);
          } else {
            api.toast({
            msg: JSON.stringify(err.msg),
            duration: 2000,
            location: 'bottom'
        });
          }
      });

    }
    var duli13;
    var duliDataList = [];
    function getDuliYS13() {
        api.showProgress({
            style: 'default',
            animationType: 'fade',
            title: '努力加载中...',
            text: '先喝杯茶...',
            modal: true
        });

        api.ajax({
            url: 'http://www.yxke12.com/index.php/App/Yishulei/dulitwo.html',
            method: 'post',
            data: {
                values: {
                }
            }
        },function(ret, err){
          api.hideProgress();
            if (ret) {
              duliDataList = ret.data;
                // console.log("getDuliYS13 " + JSON.stringify( ret ) );
                if (duli13 == null) {
                  duli13 = doT.template(document.getElementById('list13_s').innerHTML);
                }
                document.getElementById('list13_ul').innerHTML = duli13(duliDataList);
            } else {
              api.toast({
              msg: JSON.stringify(err.msg),
              duration: 2000,
              location: 'bottom'
          });
            }
        });
    }

    // 资讯item点击回调 复用自主招生详情界面 包括详情url
    function onZItemClick(index) {
      var id = zixunData[index].id
      api.openWin({
          name: 'zzzs_zxfl_details_win',
          url: './zzzs_zxfl_details_win.html',
          pageParam: {
              id: id,
              title:"艺体招生"
          }
      });

    }

    // 方略item点击回调 复用自主招生详情界面 包括详情url
    function onFItemClick(index) {
      var id = fangLueData[index].id;
      api.openWin({
          name: 'zzzs_zxfl_details_win',
          url: './zzzs_zxfl_details_win.html',
          pageParam: {
              id: id,
              title:"艺体招生"
          }
      });
    }

    var schooltype_flag = [1, 0];
    var cur_school_type = 1;
    function onSchoolType(value) {
      cur_school_type = value;
      var sa = $api.byId('school_addr');
      var t31 = $api.byId('title31');
      var l31 = $api.byId('list31_ul');
      var t13 = $api.byId('title13');
      var l13 = $api.byId('list13_ul');
        if (value == 1) {
          // 非独立院校

          // 显示省份筛选
          // 隐藏下面列表
          // 隐藏两个标题
          sa.style.display = "inline-block";
          t31.style.display = "none";
          l31.style.display = "block";
          t13.style.display = "none";
          l13.style.display = "none";
          var obj = {};
          obj.list = feiduliList;
          obj.province = provinceList;
          document.getElementById('ptgx_ul').innerHTML = yuanxiao(obj);
        }else{
          // 独立院校

          // 隐藏省份筛选
          // 显示两个列表 13所 31所
          // 显示两个标题
          sa.style.display = "none";
          t31.style.display = "block";
          l31.style.display = "block";
          t13.style.display = "block";
          l13.style.display = "block";
          if(schooltype_flag[value - 1] == 0){
            schooltype_flag[value - 1] = 1;
              getDuliYS();
              getDuliYS13();
          }else {
            var obj = {};
            obj.list = duliDataList31;
            obj.province = provinceList;
            document.getElementById('ptgx_ul').innerHTML = yuanxiao(obj);
          }
        }
    }

    function onProvince(value) {
      api.showProgress({
          style: 'default',
          animationType: 'fade',
          title: '努力加载中...',
          text: '先喝杯茶...',
          modal: true
      });

        api.ajax({
            url: 'http://www.yxke12.com/index.php/App/Yishulei/province.html',
            method: 'post',
            data: {
                values: {
                    province: value
                },
            }
        },function(ret, err){
          api.hideProgress();

            if (ret) {
                console.log( JSON.stringify( ret ) );
                feiduliList = ret.data;
                var obj = {};
                obj.list = feiduliList;
                obj.province = provinceList;
                document.getElementById('ptgx_ul').innerHTML = yuanxiao(obj);
            } else {
              api.toast({
              msg: JSON.stringify(err.msg),
              duration: 2000,
              location: 'bottom'
          });
            }
        });
    }

    function onFirstItemClick(index) {
      var id;
      if (cur_school_type == 1) {
        // 非独立
        id  = feiduliList[index].id;
      }else{
        // 独立
        id = duliDataList31[index].id;
      }

      api.openWin({
          name: 'dyzs_jz_details_win',
          url: './dyzs_jz_details_win.html',
          pageParam: {
              id: id,
              url:'http://www.yxke12.com/index.php/App/Yishulei/details.html'
          }
      });
    }

    function onSecondItemClick(index) {
      var id = duliDataList[index].id;
      api.openWin({
          name: 'dyzs_jz_details_win',
          url: './dyzs_jz_details_win.html',
          pageParam: {
              id: id,
              url:'http://www.yxke12.com/index.php/App/Yishulei/details.html'
          }
      });
    }

    function checkYSTJZDetails(index) {
      var id = ystJZList[index].id;
      api.openWin({
          name: 'dyzs_jz_details_win',
          url: './dyzs_jz_details_win.html',
          pageParam: {
              id: id,
              url:'http://www.yxke12.com/index.php/App/Yishulei/yishudetail.html'
          }
      });
    }
    function shengfen(value) {
      api.showProgress({
          style: 'default',
          animationType: 'fade',
          title: '努力加载中...',
          text: '先喝杯茶...',
          modal: true
      });

      api.ajax({
          url: 'http://www.yxke12.com/index.php/App/Yishulei/yishutuansearch.html',
          method: 'post',
          data: {
              values: {
                  province: value
              }
          }
      },function(ret, err){
        api.showProgress({
            style: 'default',
            animationType: 'fade',
            title: '努力加载中...',
            text: '先喝杯茶...',
            modal: true
        });
        if (ret) {
            api.hideProgress();
            ystJZList = ret.data;
            if (ystjz_dot == null) {
              ystjz_dot = doT.template(document.getElementById('ystjz_s').innerHTML);
            }
            document.getElementById('ystjz_tb').innerHTML = ystjz_dot(ystJZList);
        } else {
          api.toast({
          msg: JSON.stringify(err.msg),
          duration: 2000,
          location: 'bottom'
      });
        }
      });
    }
</script>
</html>
